name: pre-commit-validate
description: 커밋 전 유효성 검사
enabled: true

actions:
  - type: check
    name: lint
    description: 코드 린트 검사
    command: |
      if [ -f "package.json" ]; then
        npm run lint 2>/dev/null || npx eslint . 2>/dev/null
      elif [ -f "pyproject.toml" ] || [ -f "setup.py" ]; then
        python -m flake8 . 2>/dev/null || python -m pylint . 2>/dev/null
      fi
    failOnError: false
    warnOnError: true

  - type: check
    name: format
    description: 코드 포맷 검사
    command: |
      if [ -f "package.json" ]; then
        npx prettier --check . 2>/dev/null
      elif [ -f "pyproject.toml" ]; then
        python -m black --check . 2>/dev/null
      fi
    failOnError: false
    warnOnError: true

  - type: check
    name: type-check
    description: 타입 검사
    command: |
      if [ -f "tsconfig.json" ]; then
        npx tsc --noEmit 2>/dev/null
      elif [ -f "pyproject.toml" ]; then
        python -m mypy . 2>/dev/null
      fi
    failOnError: false
    warnOnError: true

  - type: check
    name: test
    description: 테스트 실행
    command: |
      if [ -f "package.json" ]; then
        npm test 2>/dev/null
      elif [ -f "pyproject.toml" ] || [ -f "pytest.ini" ]; then
        python -m pytest 2>/dev/null
      fi
    failOnError: false
    warnOnError: true

  - type: check
    name: security-audit
    description: 보안 감사
    command: |
      if [ -f "package.json" ]; then
        npm audit --audit-level=high 2>/dev/null
      elif [ -f "requirements.txt" ]; then
        safety check -r requirements.txt 2>/dev/null
      fi
    failOnError: false
    warnOnError: true
